# Unveiling hidden risks in healthcare from flood-induced transportation disruption

## 
Here, we provide the code used for the analysis that we used in the article "Unveiling hidden risks in healthcare from flood-induced transportation disruption". As the computation for the RoadNetworks that we analysed in this manuscript is quite large, the computational load is quite high. We pre-computed the load values on HPC and provide the results here. The code for the analysis for the manuscript can be found in germanyFloods. The figures of the manuscript can be found in germanyFloods/figs.

We provide the interactive maps seperately.

# Data and structure

The repo is structured the following way:

```
├── cache/  
├── data/  
│   ├── osmfiles
│   ├── GHSL
│   ├── GMP  
│   ├── ...

├── data_LFS/haz/rim2019/  
│   ├── 03_rasters 
│   ├── 0303_downscale_20240629
│   ├── ...  

├── germanyFloods/  
│   ├── figs
│   ├── evaluation
│   ├── data
├── src/  
│   ├── ...
```


## rasterfiles
In data_LFS you can find the flood rasters generated by the Regional Flood model. In 03_rasters we provide the 100m resolution files, and in 0303_downscale_20240629 the downscaled 5m resolution rasters.


## Add data sources
To get the code running, you will need several data sets that you need to download yourself and add to the folder data/.

-data/osmfiles  
i) Go to [Geofabrik](https://download.geofabrik.de/), locate, and download the europe.osm.pbf file. This file contains the OpenStreetMap (OSM) dump for the entire European continent, approximately 30 GB in size.
ii) Place the downloaded europe.osm.pbf file in your designated folder data/osmfiles.
iii) (Optionally) Use the provided data/germany_buffered_200km.geojson file to trim the europe.osm.pbf data. This will reduce the dataset to focus on Germany plus a 200 km buffer around it, which cuts the file size down to roughly 10 GB.

-data/GHSL  
On the [Global Human Settlement Layer](https://ghsl.jrc.ec.europa.eu/download.php?ds=pop) under product select "GHS-POP" and the epoch 2020. Chose the resolution 100m and the Mollweider CRS. Now on the map select the tile R4-C19 to start the download. The *.tif file contains a population raster of the selected area.

-data/GMP  
For the [German Mobility Panel](https://daten.clearingstelle-verkehr.de/order-form.html#192) order the the data set "Mobility Panel Germany (MOP) 1994-2021". The survey results are in a separate folder for each survey year and are available in *.csv format. We need the GMP data for estimation of $\gamma$, as well as for fitting the travel probability function $P(t_{n\rightarrow m})$. You can still run the analysis without the GMP data, as we provide the fit for $P(t_{n\rightarrow m})$ seperately.

## Add paths to the data sources
Before running the code you need to set the paths in the following to the correct files/dirs.

1) In src/RoadNetwork set PATH_TO_OSMFILES = "data/osmfiles/date-of-dump/"
2) In src/FloodModule set PATH_TO_FLOOD_SHAPE = "data/EMSR517flood-shape.shp"
3) In src/PopulationFromRaster set PATH_TO_GHSL_TIF = "data/GHSL/population-raster.tif"
4) In src/GermanMobilityPanel set PATH_TO_GMP = "data/GMP/mobility"
